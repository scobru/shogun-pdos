<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>TIMER</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
<style>
    body {
        padding: 20px;
        padding-bottom: 100px;
        
        align-items: center;
    }

    .container {
        width: 100%;
        max-width: 400px;
    }

    header {
        text-align: center;
        margin-bottom: 30px;
    }.tabs {
        display: flex;
        border: 1px solid var(--border-color);
        margin-bottom: 40px;
    }

    .tab {
        flex: 1;
        background: transparent;
        border: none;
        color: var(--text-color);
        font-family: var(--font-stack);
        padding: 12px;
        cursor: pointer;
        text-transform: uppercase;
        font-size: 14px;
        border-right: 1px solid var(--border-color);
    }

    .tab:last-child {
        border-right: none;
    }

    .tab:hover {
        background: #333;
    }

    .tab.active {
        background: var(--text-color);
        color: var(--bg-color);
    }

    .panel {
        display: none;
        text-align: center;
    }

    .panel.active {
        display: block;
    }

    .time-display {
        font-size: 64px;
        font-weight: normal;
        letter-spacing: -2px;
        margin-bottom: 40px;
        font-variant-numeric: tabular-nums;
    }

    .time-display .ms {
        font-size: 32px;
        opacity: 0.5;
    }

    .controls {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin-bottom: 40px;
    }

    .control-btn {
        background: transparent;
        border: 1px solid var(--border-color);
        color: var(--text-color);
        font-family: var(--font-stack);
        font-size: 16px;
        padding: 16px 32px;
        text-transform: uppercase;
        cursor: pointer;
        min-width: 120px;
    }

    .control-btn:hover {
        background: var(--text-color);
        color: var(--bg-color);
    }

    .control-btn:disabled {
        opacity: 0.3;
        cursor: not-allowed;
        background: transparent;
        color: var(--text-color);
    }

    .control-btn.active-state {
        border-color: var(--accent-color);
        color: var(--accent-color);
    }

    .control-btn.active-state:hover {
        background: var(--accent-color);
        color: var(--text-color);
    }

    /* Laps */
    .laps-list {
        list-style: none;
        text-align: left;
        border-top: 1px solid var(--border-color);
        max-height: 200px;
        overflow-y: auto;
    }

    .lap-item {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        border-bottom: 1px solid #333;
        font-size: 14px;
        text-transform: uppercase;
    }

    /* Countdown Setup */
    .time-inputs {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin-bottom: 40px;
    }

    .time-inputs input {
        background: transparent;
        border: 1px solid var(--border-color);
        color: var(--text-color);
        font-family: var(--font-stack);
        font-size: 32px;
        width: 60px;
        text-align: center;
        padding: 8px;
    }

    .time-inputs span {
        font-size: 32px;
    }

    .presets {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
        margin-bottom: 30px;
    }

    .preset-btn {
        background: transparent;
        border: 1px solid #333;
        color: #999;
        font-family: var(--font-stack);
        padding: 8px 12px;
        cursor: pointer;
        font-size: 12px;
        text-transform: uppercase;
    }

    .preset-btn:hover {
        border-color: var(--border-color);
        color: var(--text-color);
    }

    /* Progress Ring */
    .ring-container {
        position: relative;
        width: 200px;
        height: 200px;
        margin: 0 auto 40px;
    }

    .ring-svg {
        transform: rotate(-90deg);
        width: 100%;
        height: 100%;
    }

    .ring-bg {
        fill: none;
        stroke: #333;
        stroke-width: 2;
    }

    .ring-progress {
        fill: none;
        stroke: var(--text-color);
        stroke-width: 2;
        stroke-dasharray: 628;
        /* 2*PI*100 */
        stroke-dashoffset: 0;
        transition: stroke-dashoffset 0.1s linear;
    }

    .ring-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 32px;
        font-variant-numeric: tabular-nums;
    }

    /* Toolbar */
    .toolbar {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: var(--bg-color);
        border-top: 1px solid var(--border-color);
        display: flex;
        justify-content: space-around;
        padding: 16px;
    }

    .toolbar a {
        color: var(--text-color);
        text-decoration: none;
        font-family: var(--font-stack);
        font-size: 14px;
        text-transform: uppercase;
    }
</style>

<div class="container">
    <header>
        <h1>TIMER</h1>
    </header>

    <div class="tabs">
        <button class="tab active" data-tab="stopwatch">STOPWATCH</button>
        <button class="tab" data-tab="countdown">COUNTDOWN</button>
    </div>

    <!-- Stopwatch -->
    <div class="panel active" id="stopwatch-panel">
        <div class="time-display" id="sw-display">00:00<span class="ms">.00</span></div>

        <div class="controls">
            <button class="control-btn" id="sw-lap" disabled>LAP</button>
            <button class="control-btn" id="sw-toggle">START</button>
            <button class="control-btn" id="sw-reset" disabled>RESET</button>
        </div>

        <ul class="laps-list" id="laps-list"></ul>
    </div>

    <!-- Countdown -->
    <div class="panel" id="countdown-panel">
        <div id="cd-setup">
            <div class="time-inputs">
                <input type="number" id="cd-h" placeholder="00"><span>:</span>
                <input type="number" id="cd-m" placeholder="05"><span>:</span>
                <input type="number" id="cd-s" placeholder="00">
            </div>

            <div class="presets">
                <button class="preset-btn" data-time="60">1 Min</button>
                <button class="preset-btn" data-time="180">3 Min</button>
                <button class="preset-btn" data-time="300">5 Min</button>
                <button class="preset-btn" data-time="600">10 Min</button>
                <button class="preset-btn" data-time="1500">25 Min</button>
            </div>

            <div class="controls">
                <button class="control-btn" id="cd-start">START</button>
            </div>
        </div>

        <div id="cd-active" style="display:none;">
            <div class="ring-container">
                <svg class="ring-svg" viewBox="0 0 204 204">
                    <circle class="ring-bg" cx="102" cy="102" r="100"></circle>
                    <circle class="ring-progress" id="progress-ring" cx="102" cy="102" r="100"></circle>
                </svg>
                <div class="ring-text" id="cd-display">00:00:00</div>
            </div>

            <div class="controls">
                <button class="control-btn" id="cd-cancel">CANCEL</button>
                <button class="control-btn" id="cd-pause">PAUSE</button>
            </div>
        </div>
    </div>
</div>

<div class="toolbar">
    <a href="index.html">[HOME]</a>
</div>

<script>
    // Tab Switching
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.tab + '-panel').classList.add('active');
        });
    });

    // STOPWATCH
    let swTime = 0;
    let swInterval = null;
    let swRunning = false;
    let swLastLap = 0;

    const swDisplay = document.getElementById('sw-display');
    const swToggle = document.getElementById('sw-toggle');
    const swLap = document.getElementById('sw-lap');
    const swReset = document.getElementById('sw-reset');
    const lapsList = document.getElementById('laps-list');

    swToggle.addEventListener('click', () => {
        if (swRunning) {
            clearInterval(swInterval);
            swToggle.textContent = 'RESUME';
        } else {
            const startTime = Date.now() - swTime;
            swInterval = setInterval(() => {
                swTime = Date.now() - startTime;
                updateSwDisplay();
            }, 10);
            swToggle.textContent = 'STOP';
        }
        swRunning = !swRunning;
        swLap.disabled = !swRunning;
        swReset.disabled = false;
        updateSwButtons();
    });

    swReset.addEventListener('click', () => {
        clearInterval(swInterval);
        swRunning = false;
        swTime = 0;
        swLastLap = 0;
        lapsList.innerHTML = '';
        updateSwDisplay();
        swToggle.textContent = 'START';
        swLap.disabled = true;
        swReset.disabled = true;
        updateSwButtons();
    });

    swLap.addEventListener('click', () => {
        const lapTime = swTime - swLastLap;
        const li = document.createElement('li');
        li.className = 'lap-item';
        li.innerHTML = `<span>LAP</span> <span>${formatSw(lapTime)}</span>`;
        lapsList.prepend(li);
        swLastLap = swTime;
    });

    function updateSwButtons() {
        if (swRunning) swToggle.classList.add('active-state');
        else swToggle.classList.remove('active-state');
    }

    function formatSw(ms) {
        const m = Math.floor(ms / 60000).toString().padStart(2, '0');
        const s = Math.floor((ms % 60000) / 1000).toString().padStart(2, '0');
        const c = Math.floor((ms % 1000) / 10).toString().padStart(2, '0');
        return `${m}:${s}.${c}`;
    }

    function updateSwDisplay() {
        const m = Math.floor(swTime / 60000).toString().padStart(2, '0');
        const s = Math.floor((swTime % 60000) / 1000).toString().padStart(2, '0');
        const c = Math.floor((swTime % 1000) / 10).toString().padStart(2, '0');
        swDisplay.innerHTML = `${m}:${s}<span class="ms">.${c}</span>`;
    }

    // COUNTDOWN
    let cdTime = 0;
    let cdTotal = 0;
    let cdInterval = null;
    let cdRunning = false;

    const cdSetup = document.getElementById('cd-setup');
    const cdActive = document.getElementById('cd-active');
    const cdDisplay = document.getElementById('cd-display');
    const progressRing = document.getElementById('progress-ring');
    const cdStart = document.getElementById('cd-start');
    const cdPause = document.getElementById('cd-pause');
    const cdCancel = document.getElementById('cd-cancel');

    const CIRCUMFERENCE = 2 * Math.PI * 100;
    progressRing.style.strokeDasharray = CIRCUMFERENCE;

    document.querySelectorAll('.preset-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const s = parseInt(btn.dataset.time);
            document.getElementById('cd-h').value = Math.floor(s / 3600) || '';
            document.getElementById('cd-m').value = Math.floor((s % 3600) / 60) || '';
            document.getElementById('cd-s').value = (s % 60) || '';
        });
    });

    cdStart.addEventListener('click', () => {
        const h = parseInt(document.getElementById('cd-h').value) || 0;
        const m = parseInt(document.getElementById('cd-m').value) || 0;
        const s = parseInt(document.getElementById('cd-s').value) || 0;

        cdTotal = (h * 3600 + m * 60 + s) * 1000;
        if (cdTotal <= 0) return;

        cdTime = cdTotal;
        cdSetup.style.display = 'none';
        cdActive.style.display = 'block';

        startCd();
    });

    function startCd() {
        const endTime = Date.now() + cdTime;
        cdRunning = true;
        cdPause.textContent = 'PAUSE';

        cdInterval = setInterval(() => {
            cdTime = endTime - Date.now();
            if (cdTime <= 0) {
                cdTime = 0;
                clearInterval(cdInterval);
                playAlarm();
            }
            updateCdDisplay();
        }, 100);
    }

    cdPause.addEventListener('click', () => {
        if (cdRunning) {
            clearInterval(cdInterval);
            cdPause.textContent = 'RESUME';
        } else {
            startCd();
        }
        cdRunning = !cdRunning;
    });

    cdCancel.addEventListener('click', () => {
        clearInterval(cdInterval);
        cdRunning = false;
        cdSetup.style.display = 'block';
        cdActive.style.display = 'none';
        stopAlarm();
    });

    function updateCdDisplay() {
        const totalSec = Math.ceil(cdTime / 1000);
        const h = Math.floor(totalSec / 3600).toString().padStart(2, '0');
        const m = Math.floor((totalSec % 3600) / 60).toString().padStart(2, '0');
        const s = (totalSec % 60).toString().padStart(2, '0');
        cdDisplay.textContent = `${h}:${m}:${s}`;

        const offset = CIRCUMFERENCE - (cdTime / cdTotal) * CIRCUMFERENCE;
        progressRing.style.strokeDashoffset = offset;
    }

    // Audio
    let audioCtx = null;
    function playAlarm() {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = audioCtx.createOscillator();
        osc.connect(audioCtx.destination);
        osc.type = 'square';
        osc.frequency.value = 440;
        osc.start();
        setTimeout(() => { osc.stop(); stopAlarm(); }, 2000);
    }

    function stopAlarm() {
        if (audioCtx) { audioCtx.close(); audioCtx = null; }
    }

</script>
